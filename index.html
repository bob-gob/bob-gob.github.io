<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite 4 | Global Portal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body { background-color: #0b101b; color: #00d4ff; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; overflow: hidden; transition: border 0.3s; }
        .box { border: 2px solid #00d4ff; padding: 40px; border-radius: 20px; text-align: center; box-shadow: 0 0 30px rgba(0, 212, 255, 0.4); background: rgba(0, 0, 0, 0.95); max-width: 450px; width: 90%; position: relative; z-index: 10; }
        
        /* Global Red Alert Flashing */
        .global-lock-active { border: 10px solid #ff4d4d; animation: redPulse 1.5s infinite; }
        @keyframes redPulse { 0% { box-shadow: inset 0 0 50px #ff4d4d, 0 0 20px #ff4d4d; } 50% { box-shadow: inset 0 0 100px #ff4d4d, 0 0 50px #ff4d4d; } 100% { box-shadow: inset 0 0 50px #ff4d4d, 0 0 20px #ff4d4d; } }

        .password-container { position: relative; width: 100%; max-width: 300px; margin: 20px auto; }
        input { background: #000; border: 1px solid #00d4ff; color: #39FF14; padding: 12px; text-align: center; width: 100%; outline: none; font-size: 1.2em; box-sizing: border-box; }
        .toggle-password { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; user-select: none; font-size: 1.2em; filter: drop-shadow(0 0 5px #00d4ff); }
        
        button { background: #00d4ff; border: none; padding: 12px 25px; cursor: pointer; font-weight: bold; color: #000; text-transform: uppercase; margin-top: 10px; transition: 0.2s; }
        button:hover:not(:disabled) { background: #39FF14; box-shadow: 0 0 15px #39FF14; }

        #sync-screen, #wipe-screen, #login-screen, #loading-screen, #final-dashboard { display: none; }
        
        .spinner { border: 5px solid rgba(0, 212, 255, 0.1); border-left-color: #39FF14; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        
        #final-dashboard { width: 95%; max-width: 1200px; flex-direction: column; align-items: center; padding: 30px 10px; }
        .card { background: rgba(255, 255, 255, 0.05); border: 1px solid #00d4ff; padding: 20px; border-radius: 15px; width: 100%; max-width: 400px; margin-top: 20px; }
        .log-text { font-size: 0.7em; color: #888; margin-top: 20px; text-transform: uppercase; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="box" id="sync-screen" style="display: block;">
        <div class="spinner"></div>
        <p>INITIALIZING GLOBAL SYNC...</p>
    </div>

    <div class="box" id="wipe-screen">
        <h1 style="color: #ff4d4d; letter-spacing: 2px;">GLOBAL LOCKDOWN</h1>
        <p style="color: #ff4d4d; font-weight: bold;">CRITICAL SECURITY OVERRIDE ACTIVE</p>
        <p style="color: #ccc; font-size: 0.8em;">All users are blocked until restoration code is validated.</p>
        <div class="password-container">
            <input type="password" id="override-pass" placeholder="TYPE 18GB" style="border-color: #ff4d4d; color: #ff4d4d;">
        </div>
        <button onclick="globalRestore()" style="background: #ff4d4d; color: white;">EXECUTE GLOBAL RESTORE</button>
    </div>

    <div class="box" id="login-screen">
        <h1 style="letter-spacing: 3px;">ELITE 4 PORTAL</h1>
        <div class="password-container">
            <input type="password" id="user-pass" placeholder="ACCESS KEY" autofocus>
            <span class="toggle-password" onclick="toggleVisibility()">üëÅÔ∏è</span>
        </div>
        <button onclick="checkLogin()">VALIDATE</button>
        <p id="attempt-warning" style="color: #ff4d4d; font-size: 0.8em; margin-top: 15px;"></p>
    </div>

    <div class="box" id="loading-screen">
        <div class="spinner"></div>
        <h2>SYNCING VAULT...</h2>
    </div>

    <div id="final-dashboard">
        <h2 style="color: #39FF14;">> SYSTEM_ACCESS_GRANTED</h2>
        <div class="card">
            <h3>PROJECT DATA</h3>
            <p>Vault status: <span style="color: #39FF14;">DECRYPTED</span></p>
            <p>Global sync: <span style="color: #39FF14;">CONNECTED</span></p>
            <div class="log-text">
                OVERRIDE LOG: <span id="override-count" style="color: #ff4d4d;">0</span> EVENTS DETECTED
            </div>
        </div>
        <button onclick="location.reload()" style="margin-top: 20px; border: 1px solid #ff4d4d; background: transparent; color: #ff4d4d;">SECURE LOG OUT</button>
    </div>

    <script>
        // API Configuration for Global Sync
        const NAMESPACE = "elite4_portal_2026_V3";
        const KEY = "global_lock";
        const API_GET = `https://api.counterapi.dev/v1/${NAMESPACE}/${KEY}`;
        const API_HIT = `https://api.counterapi.dev/v1/${NAMESPACE}/${KEY}/up`;

        let localAttempts = 0;

        async function init() {
            try {
                const res = await fetch(API_GET);
                const data = await res.json();
                
                // Count how many times override was used (Every 2 hits is 1 event)
                const eventCount = Math.floor(data.count / 2);
                document.getElementById('override-count').innerText = eventCount;

                // If count is ODD = LOCKED. EVEN = OPEN.
                if (data.count % 2 !== 0) {
                    document.body.classList.add('global-lock-active');
                    showScreen("wipe-screen");
                } else {
                    document.body.classList.remove('global-lock-active');
                    showScreen("login-screen");
                }
            } catch (err) {
                // First run: Create key (Hit twice to set to 2/Open)
                await fetch(API_HIT);
                await fetch(API_HIT);
                showScreen("login-screen");
            }
        }

        function showScreen(id) {
            document.getElementById("sync-screen").style.display = "none";
            document.getElementById("wipe-screen").style.display = "none";
            document.getElementById("login-screen").style.display = "none";
            document.getElementById("loading-screen").style.display = "none";
            document.getElementById("final-dashboard").style.display = "none";
            
            const target = document.getElementById(id);
            if (id === "final-dashboard") target.style.display = "flex";
            else target.style.display = "block";
        }

        function toggleVisibility() {
            const p = document.getElementById("user-pass");
            p.type = (p.type === "password") ? "text" : "password";
        }

        async function checkLogin() {
            const pass = document.getElementById("user-pass").value.trim().toLowerCase();
            if (pass === "printing4") {
                showScreen("loading-screen");
                setTimeout(() => showScreen("final-dashboard"), 1500);
            } else {
                localAttempts++;
                document.getElementById("attempt-warning").innerText = `SECURITY WARNING: ${10 - localAttempts} ATTEMPTS LEFT`;
                
                if (localAttempts >= 10) {
                    // Trigger Global Lock by hitting the API (making it Odd)
                    await fetch(API_HIT); 
                    location.reload();
                }
            }
        }

        async function globalRestore() {
            const code = document.getElementById("override-pass").value.trim().toLowerCase();
            if (code === "18gb") {
                // Restore Global Access by hitting the API (making it Even)
                await fetch(API_HIT);
                alert("GLOBAL AUTHENTICATION SUCCESSFUL. SYSTEM RESTORED.");
                location.reload();
            } else {
                alert("INVALID KEY. ACCESS DENIED.");
            }
        }

        init();
    </script>
</body>
</html>
